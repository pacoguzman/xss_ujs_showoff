<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Presentation</title>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  

  

  <script type="text/javascript">
  $(function(){
    setupPreso(false, './');
  });
  </script>
</head>

<body>


<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">&larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">z</td><td>toggle help (this)</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content smaller" ref="intro/intro/1">
<h1>@pacoguzman</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/intro/2">
<h1>ActionView</h1>

<h1>actionview-3.0.0.beta4</h1>

<ul>
<li>HTML5</li>
<li>XSS</li>
<li>i18n</li>
<li>UJS</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="html5/html5/1">
<h1>HTML5 by default</h1>

<pre class="sh_html"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  ....
  &lt;%= csrf_meta_tag %&gt;
  ...
&lt;/head&gt;
  ...
&lt;/html&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code smaller" ref="html5/html5/2">
<h1>HTML5 helpers</h1>

<pre class="sh_ruby"><code>module ActionView::Helpers::FormHelper
  # Returns a text_field of type "search".
  def search_field(object_name, method, options = {}); ...; end

  # Returns a text_field of type "tel".
  def telephone_field(object_name, method, options = {}); ...; end

  # Returns a text_field of type "url".
  def url_field(object_name, method, options = {}); ...; end

  # Returns a text_field of type "email".
  def email_field(object_name, method, options = {}); ...; end

  # Returns an input tag of type "number".
  def number_field(object_name, method, options = {}); ...; end

  # Returns an input tag of type "range".
  def range_field(object_name, method, options = {}); ...; end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code smaller" ref="html5/html5/3">
<h1>HTML5 helpers</h1>

<pre class="sh_ruby"><code>module ActionView::Helpers::FormHelper
  # * Accepts the same options as text_field_tag.
  def search_field_tag(name, value = nil, options = {}); ...; end

  # * Accepts the same options as text_field_tag.
  def telephone_field_tag(name, value = nil, options = {}); ...; end
  alias phone_field_tag telephone_field_tag

  # * Accepts the same options as text_field_tag.
  def url_field_tag(name, value = nil, options = {}); ...; end

  # * Accepts the same options as text_field_tag.
  def email_field_tag(name, value = nil, options = {}); ...; end

  ...
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code smaller" ref="html5/html5/4">
<h1>HTML5 helpers</h1>

<pre class="sh_ruby"><code>module ActionView::Helpers::FormHelper
  ...
  # Creates a number field.
  #
  # ==== Options
  # * &lt;tt&gt;:min&lt;/tt&gt; - The minimum acceptable value.
  # * &lt;tt&gt;:max&lt;/tt&gt; - The maximum acceptable value.
  # * &lt;tt&gt;:in&lt;/tt&gt; - A range specifying the &lt;tt&gt;:min&lt;/tt&gt; and
  #   &lt;tt&gt;:max&lt;/tt&gt; values.
  # * &lt;tt&gt;:step&lt;/tt&gt; - The acceptable value granularity.
  # * Otherwise accepts the same options as text_field_tag.
  #
  # ==== Examples
  #   number_field_tag 'quantity', nil, :in =&gt; 1...10
  #   =&gt; &lt;input id="quantity" name="quantity" min="1" max="9" /&gt;
  def number_field_tag(name, value = nil, options = {}); ...; end

  # * Accepts the same options as number_field_tag.
  def range_field_tag(name, value = nil, options = {}); ...; end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code smaller" ref="html5/html5/5">
<h1>HTML5 helpers</h1>

<pre class="sh_ruby"><code>module ActionView::Helpers::AssetTagHelper
  #   &lt;%= favicon_link_tag %&gt;
  #   &lt;link href="/favicon.ico?4649789979" rel="shortcut icon" type="image/vnd.microsoft.icon" /&gt;
  def favicon_link_tag(source='/favicon.ico', options={}); ...; end

  def video_path(source); ...; end

  def audio_path(source); ...; end

  #  video_tag("trailer")  # =&gt;
  #    &lt;video src="/videos/trailer" /&gt;
  def video_tag(sources, options = {}); ...; end

  #  audio_tag("sound")  # =&gt;
  #    &lt;audio src="/audios/sound" /&gt;
  def audio_tag(source, options = {}); ...; end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="html5/html5/6">
<h1>Error Messages Deprecated</h1>

<h3>Use - <a href="http://github.com/rails/dynamic_form" title="Dynamic Form">Dynamic Form</a></h3>

<pre class="sh_ruby"><code>module ActionView::Helpers
  module ActiveModelHelper
    # input form error_messages_for error_message_on
  end
  module ActiveModelFormBuilder
    # error_messages error_message_on
  end
end</code></pre>

<h3>http://github.com/rails/dynamic_form</h3></div>
</div><div class="slide" data-transition="none"><div class="content" ref="html5/html5/7">
<h1>Rails EDGE</h1>

<h2>Removed textlize and markdown helpers</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental smaller" ref="html5/html5/8">
<h1>Templates</h1>

<ul>
<li><p>Save your templates as UTF-8 so you do not need to do anything else for things to "just work"</p></li>
<li><p>Erb implementation Erubis</p></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="html5/html5/9">
<h1>Resources</h1>

<h3>http://github.com/rails/dynamic_form</h3></div>
</div><div class="slide" data-transition="none"><div class="content" ref="xss/xss/1">
<h1>Cross Site Scripting XSS</h1>

<h2>SafeBuffers and Rails 3.0</h2>

<h3>http://yehudakatz.com/2010/02/01/safebuffers-and-rails-3-0/</h3></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="xss/xss/2">
<h1>XSS</h1>

<ul>
<li>If a String is html_safe, ERB may insert it unaltered into the output.</li>
<li>If it is not safe, ERB must first escape it before inserting it into the output.</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code" ref="xss/xss/3">
<pre class="sh_ruby"><code>module ActiveSupport
  class SafeBuffer &lt; String
    ...
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="xss/xss/4">
<h2>Rails 2 - unsafe</h2>

<pre class="sh_ruby"><code>&lt;%= @post.body %&gt;</code></pre>

<h2>Rails 3 - unsafe</h2>

<pre class="sh_ruby"><code># Devuelven un String marcado como seguro
&lt;%= raw @post.body %&gt;

&lt;%= @post.body.html_safe %&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="xss/xss/5">
<h2>Rails 2 - safe</h2>

<pre class="sh_ruby"><code>&lt;%= h @post.body %&gt;</code></pre>

<h2>Rails 3 - safe</h2>

<pre class="sh_ruby"><code>&lt;%= @post.body %&gt;</code></pre></div>
</div><div class="slide" data-transition="fade"><div class="content bullets incremental small" ref="xss/xss/6">
<h1>Summary</h1>

<ul>
<li>If a plain String is passed into a &lt;%= %&gt;, Rails always escapes it</li>
<li><p>If a SafeBuffer is passed into a &lt;%= %&gt;, Rails does not escape it.
 To get a SafeBuffer from a String, call html_safe on it.</p></li>
<li><p>(at compile-time)</p></li>
<li>If you use the raw helper in a &lt;%= %&gt;.</li>
<li>Rails does not escape any part of a template that is not in an ERB tag.</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="xss/xss/7">
<h1>Resources</h1>

<h3>http://yehudakatz.com/2010/02/01/safebuffers-and-rails-3-0/</h3>

<h3>http://rubyonrails.org/screencasts/rails3/xss-ujs</h3></div>
</div><div class="slide" data-transition="none"><div class="content" ref="i18n/i18n/1">
<h1>I18n</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="i18n/i18n/2">
<h1>Recarga de i18n</h1>

<h2>Se a&#xF1;ade ActiveSupport::FileUpdateChecker para chequear si se deben recargar los locales trabajando en desarrollo</h2>

<h3>Tambi&#xE9;n aplicado a las rutas</h3>

<h3>&#xBF;Por qu&#xE9; no con tog?</h3></div>
</div><div class="slide" data-transition="none"><div class="content" ref="i18n/i18n/3">
<h1>Paso de par&#xE1;metros</h1>

<h2>Rails 2</h2>

<pre class="sh_ruby"><code>{{month_name}}</code></pre>

<h2>Rails 3</h2>

<pre class="sh_ruby"><code>%{month_name}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content small" ref="i18n/i18n/4">
<h1>HTML SAFE</h1>

<pre class="sh_ruby"><code># = Action View Translation Helpers
module ActionView::Helpers::TranslationHelper
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="i18n/i18n/5">
<h1>HTML SAFE</h1>

<h2>Se marcan como HTML safe las claves con el sufijo "_html" o aquellas cuyo &#xFA;ltimo elemento es "html"</h2></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="i18n/i18n/6">
<pre class="sh_ruby"><code>nombre_de_clave_html: |
    "&lt;script&gt;alert('Texto marcado como seguro')&lt;/script&gt;"
scope1
  scope2
    key
      html: |
          "&lt;script&gt;alert('Texto marcado como seguro')&lt;/script&gt;"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="i18n/i18n/7">
<h1>Interpolaci&#xF3;n de strings</h1>

<h2>i18n/core_ext/string/interpolate.rb (3 opciones)</h2>

<pre class="sh_ruby"><code># "%d %s" % [1, "message"]
# # =&gt; "1 message"

# "%{firstname}, %{lastname}" % {:firstname =&gt; "Masao", :lastname =&gt; "Mutoh"}
# # =&gt; "Masao Mutoh"

# "%&lt;integer&gt;d, %&lt;float&gt;.1f" % { :integer =&gt; 10, :float =&gt; 43.4 }
# # =&gt; "10, 43.3"</code></pre>

<h2>Incluido por defecto en Ruby 1.9 o posterior</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="i18n/i18n/8">
<h1>Resources</h1>

<h2>http://blog.plataformatec.com.br/2010/02/rails-3-i18n-changes</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="ujs/ujs/1">
<h1>UJS</h1>

<h2>C&#xF3;digo javascript en ficheros javascript no en etiquetas html</h2>

<h2>Lo enlazamos con data-attributes (via HTML5)</h2></div>
</div><div class="slide" data-transition="none"><div class="content code" ref="ujs/ujs/2">
<h1>UJS</h1>

<pre class="sh_html"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  ....
  &lt;%= csrf_meta_tag %&gt;
  ...
&lt;/head&gt;
  ...
&lt;/html&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content code smaller" ref="ujs/ujs/3">
<h1>CSRF<em>META</em>TAG</h1>

<pre class="sh_ruby"><code>module ActionView::Helpers::CsrfHelpers
  def csrf_meta_tag
    if protect_against_forgery?
      %(&lt;meta name="csrf-param" content="#{Rack::Utils.escape_html(request_forgery_protection_token)}"/&gt;\\n
        &lt;meta name="csrf-token" content="#{Rack::Utils.escape_html(form_authenticity_token)}"/&gt;).html_safe
    end
  end
end

# HTML
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  ....
  &lt;meta name="csrf-param" content="request_forgery_protection_token"/&gt;
  &lt;meta name="csrf-token" content="form_authenticity_token"/&gt;
  ...
&lt;/head&gt;
  ...
&lt;/html&gt;    </code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="ujs/ujs/4">
<h1>Data attributes</h1>

<ul>
<li><p>data-remote</p></li>
<li><p>data-method</p></li>
<li><p>data-confirm</p></li>
<li><p>data-disable-with</p></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/5">
<h1>link<em>to</em>remote</h1>

<h2>Rails 2</h2>

<pre class="sh_html"><code>&lt;%= link_to_remote 'Show', :url =&gt; post %&gt;
# javascript dentro de onclick
&lt;a href="/posts/1" onclick="new Ajax.Request("/post/1", {
asynchronous:true, evalScripts:true, parameters:'authenticity_token=' +
encodeURIComponent('9sk..44d')}); return false;"&gt;Show&lt;/a&gt;</code></pre>

<h2>Rails 3</h2>

<pre class="sh_html"><code>&lt;%= link_to 'Show', post, :remote =&gt; true %&gt;
&lt;a href="/posts/1" data-remote="true"&gt;Show&lt;/a&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/6">
<h1>remote<em>form</em>for</h1>

<h2>Ocurre lo mismo</h2>

<h2>Rails 2</h2>

<pre class="sh_html"><code>&lt;% remote_form_for(@post) do |f| %&gt;
# javascript dentro de onsubmit</code></pre>

<h2>Rails 3</h2>

<pre class="sh_html"><code>&lt;%= form_for(@post, :remote =&gt; true) do |f| %&gt;
&lt;form action="/posts" class="new_post" data-remote="true"
  id="new_post" method="post"&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/7">
<h1>link_to method :delete</h1>

<h2>Rails 2 - Rails 3</h2>

<pre class="sh_html"><code>&lt;%= link_to 'Destroy', post, :method =&gt; :delete %&gt;</code></pre>

<h2>Rails 2</h2>

<h2>javascript dentro de onclick</h2>

<h2>Rails 3</h2>

<pre class="sh_html"><code>&lt;a href="/posts/1" data-method="delete" rel="nofollow"&gt;Destroy&lt;/a&gt;</code></pre>

<h3>si utilizamos :method =&gt; :put tambi&#xE9;n tenemos rel="nofollow"</h3></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/8">
<h1>link_to method :delete with confirm</h1>

<h2>Rails 2 - Rails 3</h2>

<pre class="sh_html"><code>&lt;%= link_to 'Destroy', :method =&gt; :delete,
                       :confirm =&gt; "Are you sure?" %&gt;</code></pre>

<h2>Rails 2</h2>

<h2>javascript dentro de onclick</h2>

<h2>Rails 3</h2>

<pre class="sh_html"><code>&lt;a href="/posts/1" data-confirm="Are you sure?"
  data-method="delete" rel="nofollow"&gt;Destroy&lt;/a&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/9">
<h1>submit and :disable_with =&gt; "Please wait..." %&gt;</h1>

<h2>Rails 2</h2>

<pre class="sh_html"><code>&lt;%= f.submit 'Create Post', :disable_with =&gt; 'Please wait...' %&gt;
# 4 l&#xED;neas de javascript en onclick</code></pre>

<h2>Rails 3</h2>

<pre class="sh_html"><code>&lt;%= f.submit :disable_with =&gt; 'Please wait...' %&gt;
&lt;input data-disable-with="Please wait..."
  id="post_submit" name="commit" type="submit" value="Create Post" /&gt;</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="ujs/ujs/10">
<h1>Javascript en Rails 3</h1>

<h2>El comportamiento se a&#xF1;ade mediante el fichero</h2>

<h2>Rails.root/public/javascript/rails.js</h2>

<h2>Version Prototype o jQuery</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="ujs/ujs/11">
<h1>Se puede utilizar en rails 2</h1>

<h2>Como Teambox</h2></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="ujs/ujs/12">
<h1>jquery-ujs/rails.js</h1>

<pre class="sh_javascript"><code>/* confirmation */
$('a[data-confirm],input[data-confirm]').live('click', function ()
/* remote */
$('form[data-remote]').live('submit', function ());
$('a[data-remote],input[data-remote]').live('click', function ());
$('a[data-method]:not([data-remote])').live('click', function ());
$(disable_with_form_selector).live('ajax:before', function());
$(disable_with_form_selector).live('ajax:complete', function());</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smbullets incremental smaller" ref="ujs/ujs/13">
<h1>Faltan cosinas &#xBF;?</h1>

<h2>Deprecated methods</h2>

<ul>
<li>link<em>to</em>remote (*)</li>
<li>remote<em>form</em>for (*)</li>
<li>observe_field</li>
<li>observe_form</li>
<li>form<em>remote</em>tag (*)</li>
<li>button<em>to</em>remote</li>
<li>submit<em>to</em>remote (*)</li>
<li>link<em>to</em>function</li>
<li>periodically<em>call</em>remote</li>
</ul>


<h2>(*) partially supported using the :remote =&gt; true option</h2></div>
</div><div class="slide" data-transition="none"><div class="content smbullets smaller" ref="ujs/ujs/14">
<h2>Si quieres pasar otros callbacks ya te lo tienes que currar con puro javascript</h2>

<h3>custom events</h3>

<ul>
<li>ajax:loading</li>
<li>ajax:success</li>
<li>ajax:failure</li>
<li>ajax:complete</li>
</ul>


<h2>http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3/</h2>

<h1><a href="http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3/" title="unobtrusive javascript in rails 3">Vamos a verlo!</a></h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="ujs/ujs/15">
<h1>Resources</h1>

<h2><a href="http://www.simonecarletti.com/blog/2010/06/upgrading-rails-2-to-rails-3">Upgrading rails 2 to rails 3</a></h2>

<h2><a href="http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-technique">Unobtrusive Javascript Technique</a></h2>

<h2><a href="http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3">Unobtrusive Javascript In Rails 3</a></h2>

<h2><a href="http://blog.envylabs.com/2010/05/rails-3-tutorials/">Rails 3 Tutorials</a></h2>

<h2>http://github.com/rails/jquery-ujs</h2>

<h2>http://github.com/rails/prototype-ujs</h2></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="questions/questions/1">
<p><img src="file:///home/pacoguzman/dev/github_pacoguzman/xss_ujs_showoff/questions/question-mark2a-azul.jpg" alt="Questions?"/></p></div>
</div><div class="slide" data-transition="none"><div class="content" ref="questions/questions/2">
<h2>http://aspgems-rails3-actionview.heroku.com/</h2></div>
</div>
</div>

</body>
</html>
